<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>@ViewData["Title"] - BiblioFlow BackOffice</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="~/css/admin.css" asp-append-version="true" />
  <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>
<body>
@{
    var adminEmail = Context.Session.GetString("admin_email");
    var isAuth = !string.IsNullOrWhiteSpace(adminEmail);
}

<div class="app-shell">
  <aside class="sidebar">
    <div class="brand">
      <div class="logo">BF</div>
      <div class="txt">
        <div class="name">BiblioFlow</div>
        <div class="sub">BackOffice</div>
      </div>
    </div>

    <div class="nav-group">
      <div class="nav-title">Manage</div>

      <a class="nav-linkx" href="/Admin/Dashboard">
        Dashboard
      </a>
      <a class="nav-linkx" href="/Admin/Books">
        Books
      </a>
      <a class="nav-linkx" href="/Admin/Licenses">
        Licenses
      </a>
      <a class="nav-linkx" href="/Admin/Loans">
        Loans
      </a>
    </div>

    <div class="nav-group">
      <div class="nav-title">Tools</div>
      <a class="nav-linkx" href="/Admin/Import">
        Import
      </a>
      <a class="nav-linkx" href="/Admin/Export">
        Export
      </a>
    </div>

    <div class="mt-auto px-3 pb-3">
      @if (isAuth)
      {
        <div class="small text-muted mb-2">Signed in</div>
        <div class="d-flex align-items-center justify-content-between gap-2">
          <div class="small fw-semibold text-truncate">@adminEmail</div>
          <a class="btn btn-sm btn-outline-light" href="/Logout">Logout</a>
        </div>
      }
      else
      {
        <a class="btn btn-sm btn-light w-100" href="/Login">Login</a>
      }
    </div>
  </aside>

  <main class="content">
    <header class="topbar">
      <div class="d-flex align-items-center gap-2">
        <div class="page-title">@ViewData["Title"]</div>
      </div>
      <div class="d-flex align-items-center gap-2">
        @if (isAuth)
        {
          <span class="badge text-bg-dark">Admin</span>
        }
      </div>
    </header>

    <div class="container-fluid py-3">
      @* Flash messages *@
      @if (TempData["Msg"] is string msg && !string.IsNullOrWhiteSpace(msg))
      {
        <div class="alert alert-info border-0 shadow-sm">@msg</div>
      }
      @if (TempData["Error"] is string err && !string.IsNullOrWhiteSpace(err))
      {
        <div class="alert alert-danger border-0 shadow-sm">@err</div>
      }

      @RenderBody()
    </div>

    <footer class="footer">
      <div class="small text-muted">© @DateTime.UtcNow.Year BiblioFlow</div>
    </footer>
  </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
@RenderSection("Scripts", required: false)
</body>
</html>
